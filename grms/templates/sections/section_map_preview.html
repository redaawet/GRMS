{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Section Map Preview</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link rel="stylesheet" href="{% static 'grms/css/section-wizard.css' %}">
</head>
<body>
<div class="wizard-container">
    <h1>Road Section Wizard</h1>
    <div class="wizard-progress">
        {% for step in progress_steps %}
            <div class="wizard-progress__step {% if step.complete %}complete{% endif %} {% if step.active %}active{% endif %}">
                <span class="wizard-progress__index">{{ forloop.counter }}</span>
                <span class="wizard-progress__label">{{ step.label }}</span>
            </div>
            {% if not forloop.last %}
                <div class="wizard-progress__divider">→</div>
            {% endif %}
        {% endfor %}
    </div>

    <div class="wizard-card">
        <h2>Step 2 — Map Preview</h2>
        <p class="wizard-description">The map is generated automatically from the parent road geometry. No drawing is required. Administrative boundaries are overlaid when available.</p>
        {{ map_config|json_script:"section-map-config" }}
        <div id="section-map" class="section-map" aria-label="Section map preview"></div>
        <div class="map-legend">
            <span class="legend road"></span> Parent road geometry
            <span class="legend section"></span> Section extent ({{ section.start_chainage_km }} – {{ section.end_chainage_km }} km)
            {% if map_has_admin_boundary %}
                <span class="legend admin"></span> Admin boundary extent
            {% endif %}
        </div>
        <form method="post" class="wizard-actions">
            {% csrf_token %}
            <button type="submit" class="btn-primary">Save Section</button>
        </form>
    </div>
</div>
<script src="{% static 'grms/js/section-wizard.js' %}"></script>
</body>
</html>
