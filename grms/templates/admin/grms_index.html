{% extends "admin/custom_base_site.html" %}
{% load i18n %}

{% block bodyclass %}model-index {{ block.super }}{% endblock %}

{% block content %}
<div id="content-main">
  <div class="grms-kpi-grid">
    <div class="grms-kpi-card">
      <p class="grms-kpi-label">{% trans "Total roads" %}</p>
      <p class="grms-kpi-value">{{ admin_kpis.roads|default:0 }}</p>
    </div>
    <div class="grms-kpi-card">
      <p class="grms-kpi-label">{% trans "Total sections" %}</p>
      <p class="grms-kpi-value">{{ admin_kpis.sections|default:0 }}</p>
    </div>
    <div class="grms-kpi-card">
      <p class="grms-kpi-label">{% trans "Total segments" %}</p>
      <p class="grms-kpi-value">{{ admin_kpis.segments|default:0 }}</p>
    </div>
    <div class="grms-kpi-card">
      <p class="grms-kpi-label">{% trans "Latest traffic year" %}</p>
      <p class="grms-kpi-value">{{ admin_kpis.latest_traffic_year|default:"â€“" }}</p>
    </div>
    <div class="grms-kpi-card">
      <p class="grms-kpi-label">{% trans "Planned interventions" %}</p>
      <p class="grms-kpi-value">{{ admin_kpis.planned_interventions|default:0 }}</p>
    </div>
  </div>

  {% if menu_groups %}
    <div class="grms-dashboard-grid">
      {% for group_key, group_items in menu_groups.items %}
        <div class="grms-dashboard-card">
          <h2>{{ group_key }}</h2>
          <ul>
            {% for model in group_items %}
              <li class="grms-dashboard-item{% if model.active %} is-active{% endif %}">
                <a href="{{ model.url }}">{{ model.label }}</a>
              </li>
            {% endfor %}
          </ul>
        </div>
      {% endfor %}
    </div>
  {% elif sections or app_list %}
    <div class="grms-dashboard-grid">
      {% if sections %}
        {% for section in sections %}
          <div class="grms-dashboard-card">
            <h2>{{ section.title }}</h2>
            <ul>
              {% for model in section.models %}
                <li class="grms-dashboard-item">
                  {% if model.admin_url %}
                    <a href="{{ model.admin_url }}">{{ model.name }}</a>
                  {% else %}
                    {{ model.name }}
                  {% endif %}
                </li>
              {% endfor %}
            </ul>
          </div>
        {% endfor %}
      {% else %}
        {% for app in app_list %}
          <div class="grms-dashboard-card">
            <h2>{{ app.name }}</h2>
            <ul>
              {% for model in app.models %}
                <li class="grms-dashboard-item">
                  {% if model.admin_url %}
                    <a href="{{ model.admin_url }}">{{ model.name }}</a>
                  {% else %}
                    {{ model.name }}
                  {% endif %}
                </li>
              {% endfor %}
            </ul>
          </div>
        {% endfor %}
      {% endif %}
    </div>
  {% else %}
    <p class="empty-dashboard">{% trans "No models are registered with this admin site yet." %}</p>
  {% endif %}
</div>
{% endblock %}
