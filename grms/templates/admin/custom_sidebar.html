{% load admin_urls %}

<ul class="nav-sidebar">

{% for group_key, group_items in MENU_GROUPS.items %}

  <li class="model-group">
    <div class="group-header" data-group="{{ group_key|slugify }}">
      <span class="group-title">{{ group_key|replace:"_, " }}</span>
      <span class="toggle-icon">▸</span>
    </div>

    <ul id="group-{{ group_key|slugify }}" class="group-items collapse">

      {% if group_items.items %}
        {# ----- SUBGROUPS (Boxed Style B) ----- #}
        {% for subgroup_name, subgroup_models in group_items.items %}
          <li class="subgroup">
            <div class="subgroup-header" data-subgroup="{{ subgroup_name|slugify }}">
              <span class="subgroup-title">{{ subgroup_name }}</span>
              <span class="toggle-icon">▸</span>
            </div>
            <ul id="subgroup-{{ subgroup_name|slugify }}" class="subgroup-items collapse">
              {% for model_name, display_name in subgroup_models %}
                {% with model=get_model_by_name model_name %}
                  {% if model %}
                    <li class="model-item">
                      <a href="{% url model|admin_urlname:'changelist' %}">{{ display_name }}</a>
                    </li>
                  {% endif %}
                {% endwith %}
              {% endfor %}
            </ul>
          </li>
        {% endfor %}

      {% else %}
        {# ----- FLAT GROUP LIST ----- #}
        {% for model_name, display_name in group_items %}
          {% with model=get_model_by_name model_name %}
            {% if model %}
              <li class="model-item">
                <a href="{% url model|admin_urlname:'changelist' %}">{{ display_name }}</a>
              </li>
            {% endif %}
          {% endwith %}
        {% endfor %}
      {% endif %}

    </ul>
  </li>

{% endfor %}

</ul>
