{% extends "admin/base_site.html" %}
{% load static %}
{% block content %}
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css">
<link rel="stylesheet" href="{% static 'grms/css/dashboard.css' %}">
<div class="dashboard-wrapper">

  <h1 class="dash-title">GRMS Professional Dashboard</h1>
  <p class="dash-subtitle">Analytics overview and quick insights for gravel road management.</p>

  <div class="kpi-grid">
      <div class="kpi-card"><span>Total Roads</span><h2>{{ total_roads }}</h2></div>
      <div class="kpi-card"><span>Road Sections</span><h2>{{ total_sections }}</h2></div>
      <div class="kpi-card"><span>Road Segments</span><h2>{{ total_segments }}</h2></div>
      <div class="kpi-card"><span>Planned Interventions</span><h2>{{ planned_interventions }}</h2></div>
      <div class="kpi-card"><span>Latest Traffic Year</span><h2>{{ latest_traffic_year }}</h2></div>
  </div>

  <div class="panel-grid">
      <div class="panel">
          <h3>Surface Type Distribution</h3>
          <canvas id="surfaceChart"></canvas>
      </div>

      <div class="panel">
          <h3>Traffic Trend (ADT)</h3>
          <canvas id="trafficChart"></canvas>
      </div>
  </div>

  <div class="panel">
      <h3>Road Network Map</h3>
      <div id="map"></div>
  </div>
</div>

<script>
window.surfaceData = {{ surface_data|safe }};
window.trafficYears = {{ traffic_years|safe }};
window.trafficValues = {{ traffic_values|safe }};
</script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script src="{% static 'grms/js/dashboard.js' %}"></script>
{% endblock %}
